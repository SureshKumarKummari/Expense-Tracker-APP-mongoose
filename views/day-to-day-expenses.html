<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" initial-scale=1.0">
    <title>Document</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</head>

<body>
    <h1 style="text-align:center">Day to Day Expenses</h1>
    <div class="container justify-content-center table-responsive" style="max-width:700px;">
        <h4></h4>
        <table class="table">
            <h4 id="year"></h4>
            <h5 id="month-year"></h5>
            <thead class="thead-light bg-primary ">
                <tr>
                    <th  class="p-2 bg-primary rounded-start" style="color:white">Date</th>
                    <th  class="p-2 bg-primary" style="color:white">Description</th>
                    <th  class="p-2 bg-primary" style="color:white">Category</th>
                    <th  class="p-2 bg-primary"style="color:white">Inome</th>
                    <th  class="p-2 bg-primary rounded-end" style="color:white">Expense</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>Mark</td>
                    <td>Otto</td>
                    <td>@mdo</td>
                    <td>ok</td>
                </tr>
            </tbody>
        </table>
        <!-- <div style="text-align:center">
        <br>
    <button type="submit" class="mt-4" style="text-align:center">Generate
        Report</button>
        </div> -->
    </div>

    <br><br>

    <div class="container justify-content-center table-responsive" style="max-width:700px;">
        <table id="table" class="table">
            <h4 style="text-align:center">Yearly Report</h4>
            <thead class="thead-light bg-primary ">
                <tr>
                    <th class="p-2 bg-primary rounded-start" style="color:white">Month</th>
                    <th class="p-2 bg-primary" style="color:white">Income</th>
                    <th class="p-2 bg-primary" style="color:white">Expense</th>
                    <th class="p-2 bg-primary rounded-end" style="color:white">Savings</th>
                </tr>
            </thead>
            <tbody id="table-body">

            </tbody>
        </table>
        <!-- <div style="text-align:center">
        <br>
        <button type="submit" class="mt-4" style="text-align:center">Generate
            Report</button>
            </div> -->
    </div>

    <br><br>

    <div class="container justify-content-center table-responsive" style="max-width:700px;">
        <table id="table" class="table">
            <h4 style="text-align:center">Notes Report</h4>
            <thead class="thead-light bg-primary ">
                <tr>
                    <th class="p-2 bg-primary rounded-start" style="color:white">Date</th>
                    <th class="p-2 bg-primary rounded-end" style="color:white">Notes</th>
                </tr>
            </thead>
            <tbody id="table-body">

            </tbody>
        </table>
    <div style="text-align:center">
        <br>
        <br>
        <button type="submit" class="mt-4" style="text-align:center" id="download">Generate
            Report</button>
            </div>
    </div>

    <div class="container justify-content-center table-responsive" style="max-width:700px;">
        <ul id="downloadurls">

        </ul>
    </div>

</body>

<script>
    document.getElementById('download').onclick=async()=>{
        let token=localStorage.getItem('token');
        await axios.get("http://localhost:3000/download", { headers: { "Autherization": token } })
        .then(res=>{
            //let url=res.data.fileurl;
           // console.log(res);
            //let a=document.createElement("a");
            //a.href=`${url}`;
            //a.click();

            for(let i=0;i<res.data.length;i++){
                displayUrls(res.data[i]);
            }

        })
        .catch(err=>{
            console.log(err);
        });
    }


    function displayUrls(data){
        let ul=document.getElementById('downloadurls');
        let li=document.createElement('li');
        li.innerHTML=`<h5>Report Generated on ${dateGenerated(data.createdAt)}<h5> <a href="${data.link}">Click here</a>To download This report `;
        ul.appendChild(li);
    }

    function dateGenerated(timeString) {
            // Create a new Date object from the time string
            const date = new Date(timeString);
            // Extract year, month, and day
            const year = date.getFullYear();
            const month = ('0' + (date.getMonth() + 1)).slice(-2); // Months are zero-based
            const day = ('0' + date.getDate()).slice(-2);

            // Extract hours, minutes, and seconds
            const hours = ('0' + date.getHours()).slice(-2);
            const minutes = ('0' + date.getMinutes()).slice(-2);
            const seconds = ('0' + date.getSeconds()).slice(-2);

            // Construct the formatted date string
            const formattedDate = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;

            return formattedDate;
        }
</script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

</html>